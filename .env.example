# Ruriko Configuration
# Copy this file to examples/docker-compose/.env and fill in your values.
# See OPERATIONS.md for a step-by-step setup guide.

# Database
DATABASE_PATH=./ruriko.db

# Matrix Configuration
MATRIX_HOMESERVER=http://tuwunel:8008
MATRIX_USER_ID=@ruriko:localhost
MATRIX_ACCESS_TOKEN=your_access_token_here

# Comma-separated list of room IDs where Ruriko accepts commands
MATRIX_ADMIN_ROOMS=!adminroom:localhost

# Optional: comma-separated list of Matrix user IDs allowed to send commands
# When empty, any room member can execute commands
MATRIX_ADMIN_SENDERS=@bogdan:localhost

# Master encryption key for secrets (32-byte key encoded as 64 hex chars)
# Generate with: openssl rand -hex 32
RURIKO_MASTER_KEY=your_64_char_hex_string_here

# Docker Runtime
# Set DOCKER_ENABLE=true to enable container lifecycle management for agents
DOCKER_ENABLE=true
DOCKER_NETWORK=ruriko-net
# Optional: override Docker API endpoint used by Ruriko's runtime adapter.
# Leave empty to use the local Unix socket default.
# For hardened deployments with a socket proxy, set for example:
# DOCKER_HOST=tcp://docker-socket-proxy:2375
DOCKER_HOST=
# Optional: host docker group GID used by docker-compose group_add.
# Needed only when mounting /var/run/docker.sock directly (not via proxy).
# Example: stat -c '%g' /var/run/docker.sock
DOCKER_GID=990
# How often to reconcile container state with the DB (e.g. 30s, 1m)
RECONCILE_INTERVAL=30s

# Default container image used when creating agents via chat
DEFAULT_AGENT_IMAGE=gitai:latest

# ---------------------------------------------------------------------------
# Kuze — one-time secret entry via browser
# ---------------------------------------------------------------------------
# Base URL where Ruriko's HTTP server is reachable from a browser.
# /ruriko secrets set and /ruriko secrets rotate require Kuze one-time links.
# Keep this set in all environments where secret management is needed.
KUZE_BASE_URL=http://localhost:8080
# How long one-time links remain valid (Go duration, e.g. 10m, 1h).
KUZE_TTL=10m

# ---------------------------------------------------------------------------
# Matrix Identity Provisioning
# ---------------------------------------------------------------------------
# Set to true to allow Ruriko to automatically create Matrix accounts for agents.
MATRIX_PROVISIONING_ENABLE=true
# Homeserver type: "tuwunel" (default), "synapse", "generic", or "manual"
MATRIX_HOMESERVER_TYPE=tuwunel
# Tuwunel registration token — set during initial setup, clear after.
# Generate with: openssl rand -hex 16
TUWUNEL_REGISTRATION_TOKEN=
# Synapse shared-secret (only if using Synapse)
# MATRIX_SHARED_SECRET=
# Optional suffix appended to agent Matrix usernames (e.g. "-agent")
# MATRIX_AGENT_USERNAME_SUFFIX=

# Gosuto templates directory
TEMPLATES_DIR=./templates

# Optional: Matrix audit room for human-friendly event summaries
# MATRIX_AUDIT_ROOM=!auditroom:localhost

# Health / status HTTP server address
HTTP_ADDR=:8080

# Logging
LOG_LEVEL=info
# Use "text" for local dev, "json" for production
LOG_FORMAT=text

# ---------------------------------------------------------------------------
# Docker Compose only — local Tuwunel homeserver
# ---------------------------------------------------------------------------
# Server name for the Tuwunel homeserver.
# Must match the domain part of all MXIDs (e.g., @ruriko:localhost → localhost).
TUWUNEL_SERVER_NAME=localhost
# Bind address for Tuwunel on the host (for your Matrix client to connect)
TUWUNEL_HOST=127.0.0.1
TUWUNEL_PORT=8008
# Set to true only during initial account setup, then set back to false.
TUWUNEL_ALLOW_REGISTRATION=false

# Host bind for Ruriko health/Kuze endpoint
HTTP_ADDR_HOST=127.0.0.1
HTTP_ADDR_PORT=8080

# ---------------------------------------------------------------------------
# Natural Language Interface (R9) — LLM-backed intent classification
# ---------------------------------------------------------------------------
# Optional: API key for the LLM provider used to classify free-form messages.
# When unset, Ruriko falls back to deterministic keyword matching (R5.4).
# The key is read from this environment variable and never accepted via chat.
RURIKO_NLP_API_KEY=

# Optional: override the chat model (default: gpt-4o-mini).
# NLP_MODEL=gpt-4o-mini

# Optional: override the API endpoint for OpenAI-compatible providers.
# Leave empty for the public OpenAI endpoint.  Examples:
#   http://localhost:11434/v1   — Ollama (local)
#   https://<resource>.openai.azure.com/openai/deployments/<deployment>
# NLP_ENDPOINT=

# Optional: override which environment variable name Ruriko reads the NLP key
# from.  Leave empty to use the default (RURIKO_NLP_API_KEY).
# NLP_API_KEY_ENV=RURIKO_NLP_API_KEY

# Optional: maximum NLP classification calls per sender per minute (default: 20).
# NLP_RATE_LIMIT=20

# ---------------------------------------------------------------------------
# External Gateway Processes (R12.5)
# ---------------------------------------------------------------------------
# External gateways are binaries configured in a Gosuto YAML under the
# "gateways" key (with a "command" field).  They are supervised by Gitai
# alongside MCP server processes.  No new Ruriko env vars are required —
# all gateway configuration is driven by the Gosuto spec pushed via ACP.
#
# The Gitai supervisor automatically injects the following environment
# variables into every external gateway process at startup:
#
#   GATEWAY_TARGET_URL   — The ACP event ingress endpoint the binary must
#                          POST normalised event envelopes to, e.g.:
#                          http://127.0.0.1:8765/events/<gateway-name>
#
#   GATEWAY_<KEY>        — One variable per config entry in the Gosuto Gateway
#                          spec (key uppercased), e.g. GATEWAY_INTERVAL=30.
#
# Gateway binaries must be baked into the Gitai container image at build time
# (see deploy/docker/Dockerfile.gitai).  The ACP listen address used to
# construct GATEWAY_TARGET_URL is controlled by GITAI_ACP_ADDR (default :8765).
